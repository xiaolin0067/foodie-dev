Redis
    Nosql, 分布式缓存中间件, Key-value存储
    提供海量数据存储访问
    数据存储在内存，读取更快
    非关系型、分布式、开源、水平扩展
    持久化
    主从同步, 故障转移
    缺点：单线程、单核
与Memcache相比：Memcache不能够持久化容灾

Redis安装
https://redis.io
解压安装包，进入解压后的目录，安装gcc-c++
yum install -y gcc-c++
编译与安装
make && make install
复制Redis启动文件到/etc/init.d/
cp utils/redis_init_script /etc/init.d/
配置Redis
cd /usr/local/redis
创建工作目录
mkdir working
    编辑配置
    vim redis.conf
    在后台运行
    daemonize yes
    工作目录
    dir /usr/local/redis/working
    允许访问的IP
    bind 0.0.0.0
    访问端口
    port 6379
    访问密码
    requirepass 123456
    进程号文件
    pidfile /var/run/redis_6379.pid

编辑Redis启动脚本
    cd /etc/init.d
    vim redis_init_script
    修改配置文件
    CONF="/use/local/redis/redis.conf"
    修改脚本权限
    chmod +x redis_init_script
    启动Redis
    ./redis_init_script start
    开机自启动
    chkconfig redis_init_script on

redisl-cli使用
登录
    redis-cli 或者 redis-cli -p 6379 -h 127.0.0.1
鉴权
    auth 123456
基础使用
    set age 18
    get age
    del age
命令补全，输入命令得一部分然后按TAB键
直接在命令行使用命令
    redis-cli -a 123456 get name
    redis-cli -a 123456 ping

停止Redis
1.直接kill Redis pid
2.修改redis_init_script脚本，增加密码
$CLIEXEC -a 123456 -p $REDISPORT shutdown
保存退出后执行
./redis_init_script stop

Redis的数据类型
string类型
查看所有的key，生产环境禁用，因生产环境key太多
匹配所有
    keys *
匹配以age开头
    keys age*
查看key的value类型
    type age
set会覆盖value，SETNX则不会覆盖，若key存在则不设置
    setnx age 20
查看缓存过期时间，time to leave，-1为永不过期，-2为已过期
    ttl age
给已添加的缓存设置过期时间，单位秒
    expire age 30
设置缓存时给缓存设置过期时间，ex为s, px为ms
    set name test px 3000
清除屏幕
    clear
value拼接字符串
    append email 123
查看字符串长度
    STRLEN email
对于数字类型value累加操作，步长为1
    incr age
对于数字类型value累减操作，步长为1
    decr age
对于数字类型value累加操作，自定义步长
    INCRBY age 10
对于数字类型value累减操作，自定义步长
    DECRBY age 10
获取value字符串指定范围内的内容, -1为最后位置
    getrange age 0 -1
在指定index开始覆盖字符串
    SETRANGE email 1 abc
一次设置多个键值对
    MSET k1 v1 k2 v2
一次获取多个键值对
    MGET k1 k2
一次设置多个键值对，若设置的key中存在已存在的key，则整个操作都会撤销
    MSETNX k2 v2 k3 v3
redis默认有16个数据库，在redis.conf配置文件中配置databases 16
使用命令select ${dbIndex}来切换库，可在不同的项目中使用不同的库
清除当前库的所有数据
    flushdb
清除所有库的所有数据
    flushall

hash类型
类似与将一个map存入value中，可以将结构化数据存入redis
    hset user name testName
    hget user name
同时设置多个值
    hmset user age 18 sex man
同时获取多个值
    hmget user name age sex
获取对象所有键值对
    hgetall user
获取对象属性字段数量
    hlen user
打印对象所有的key
    hkeys user
打印对象所有的value
    hvals user
对象数字属性值增加，指定增加值
    HINCRBY user age 2
对象数字属性值增加，指定增加值为浮点数
    HINCRBYFLOAT user age 3.2
对象属性是否存在
    HEXISTS user age
删除对象属性
    HDEL user name

list类型，列表、数组
从左边添加元素
    LPUSH list1 a b c d e
查看所有元素
    LRANGE list1 0 -1
从右边添加元素
    RPUSH test2 a b c d e
从左边取出元素
    LPOP list1
从右边取出元素
    RPOP test2
查看数组长度
    llen list1
查看index位置的元素，index不存在时会提示不存在
    LINDEX list1 2
给index元素设值，index不存在时会提示不存在
    lset list1 1 888
在指定元素之前插入值，若存在多个指定元素，则只会在index最小的前插入
    LINSERT list1 before b aaa
删除指定元素，指定删除个数
    lrem list1 99999 666
截取列表，列表只保留截取index的元素，其余元素会被删除
    LTRIM list1 4 6
删除列表
    del list1

set类型
只会保留不相同的元素
添加元素
    sadd set1 a b c a a b d
查看所有元素
    smembers set1
查看元素数量
    scard set1
指定元素是否在指定set中
    SISMEMBER set1 a
删除指定set中指定元素
    srem set1 a
从set中随机取出指定数量的元素
    spop set1 2
从set中随机查看指定数量的元素，不指定数量默认为1个
    SRANDMEMBER set2 3
将指定set中的指定元素移动到另一个指定set中
    SMOVE set3 set2 d
set可以做交集、并集、差集运算
差集运算，打印在set1中在set2中不存在的元素，set1-set2
    SDIFF set1 set2
交集运算，打印在set1与set2中都存在的元素
    SINTER set1 set2
并集运算
    SUNION set1 set2

zset类型
有序的set，也叫sorted set，可排序的set，且带有分数scope
添加元素
    zadd zset1 10 a 20 b 30 c
查看所有元素
    ZRANGE zset1 0 -1
查看所有元素与元素分数
    ZRANGE zset1 0 -1 withscores
查看指定元素所在index
    ZRANK zset1 c
查看指定元素分数
    ZSCORE zset1 c
查看元素个数
    ZCARD zset
统计指定分数范围内的元素个数
    ZCOUNT zset1 11 31
查看指定分数范围内的元素
    ZRANGEBYSCORE zset1 10 30
查看指定分数范围内的元素，limit指定输出数据
    ZRANGEBYSCORE zset1 10 30 limit 1 2
查看指定分数范围内的元素，不包含最大最小值
    ZRANGEBYSCORE zset1 (10 (30
删除指定元素
    zrem zset1 a

Redis命令网址：http://redisdoc.com/

redis-cli查看中文value，登录时指定参数--raw，即：redis-cli --raw

Redis的发布与订阅
1、订阅channel(通道/频道)
SUBSCRIBE channel_1 channel_2 channel_3
2、发布者向channel发布消息
PUBLISH channel_1 channel_1-message1

指定通配符批量订阅
PSUBSCRIBE channel_*










